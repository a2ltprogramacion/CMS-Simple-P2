---
// @src/components/ProductCard.astro (VERSIÓN 5.7 - Paleta V5.1)
import type { CollectionEntry } from 'astro:content';
import { mdToHtml } from '../utils/markdown';

export interface Props {
  producto: CollectionEntry<'productos'>; // Colección renombrada
}
const { producto } = Astro.props;

// Cargar datos de la colección (con fallbacks)
const renderedTitle = producto.data.title ?? "Producto de Ejemplo";
const subtitle = producto.data.subtitle;
const description = producto.data.description;
const image = producto.data.image ?? '/assets/uploads/placeholder.jpeg';

// Renderizar Markdown
const renderedDescriptionHtml = mdToHtml(description ?? "");
---

<div class="group relative bg-secondary text-text-base shadow-lg overflow-hidden h-96 w-full cursor-pointer 
            transition-all duration-500 ease-in-out hover:shadow-2xl">
  
  <div class="absolute inset-0 bg-cover bg-center 
              transition-opacity duration-300 ease-in-out group-hover:opacity-0"
       style={`background-image: url(${image});`}>
       
    <div class="absolute inset-0 bg-primary/80 flex flex-col justify-end p-6">
      <h3 class="text-2xl font-serif font-bold mb-1 text-text-inverted">
        {renderedTitle}
      </h3>
      {subtitle && (
        <p class="text-lg text-text-inverted/90">
          {subtitle}
        </p>
      )}
    </div>
  </div>

  <div class="absolute inset-0 bg-white p-6 opacity-0 scale-95 transform 
              transition-all duration-500 ease-in-out group-hover:opacity-100 group-hover:scale-100 
              overflow-y-auto">
      
    <img src={image} alt={renderedTitle} class="w-full h-32 object-contain mb-4"/>

    <h3 class="text-2xl font-serif font-bold mb-2 text-accent-secondary">
        {renderedTitle}
    </h3>
    
    {description && (
      <div class="prose max-w-none text-text-base/90 prose-strong:text-accent-secondary">
        <span set:html={renderedDescriptionHtml} />
      </div>
    )}

    <p class="mt-4 text-sm text-primary/60">
      <a href="#contacto" class="underline text-accent-secondary hover:text-primary">Contactar para este producto</a>
    </p>
  </div>
</div>